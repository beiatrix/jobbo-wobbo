language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "jobbo-wobbo-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)
script:
  - npm test # test the code
  - npm run build-client # make the bundle

before_deploy:
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: jobbo-wobbo # see README
  api_key:
    secure: 'KdRsvTelt8cZC75+U54WX9v/vTD1lCWo14E4Kf9LVoLUSsawNklgBpGoh9euNnsFkF4b5Ff9uGk5oTECQCGbsKQ8y85KrZAlPSr9YP7YllvAJz+w6U//hTL0jvJReyy3OQKJpt6vEZoioV+1zgMFgCqciP90oIj1UWAAD2pzecqp/1jzJ4fd4hLpGWAKYC1tfPAPKfg/VrNv5N1gENkFMym2AXtLtyA1ayqjrUjaeskJWbb9YCwZrwXK1hysO8Pt5dZbg1ePlt6OJoSS97mN7uD7moi+NkSR1EQbFJjxidFYVCUhDPF12dCY+3PctoaooCqAZdRKvgcG4OpP4PLEvrkuGFlFhlLy5ELO3aivbmNeXq/kw2Uq1Z9tjykalHmCfJE6Cvrg3FEPssbYN7eXgTA37m4kTT8i4O90yEkr6AlD8EbLtfo4nmNq6HTXH+FXj0j3vn1Sf4vrG7CMYrAsSeU07n2vdNuk+ojq08OQEtyYHc+FQjNsd4aHnf/4Pi2A+VWpVJOutFOTahVhNFwTZR9tjkg5tQUEME43kS9Pwm5GshuamlA6th6MdfBXIi90W5xz511HDONc1woD22oG3+qPvrxIIhlhdKBYILWVl8zxqvsFEgbNLbaFn7eYVd1KcElaSsUqK0wZlLQbAy5sK6FbjjKhWHPOvVUukxE2v8g=' # see README
